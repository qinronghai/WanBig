{"version":3,"sources":["uni-app:///main.js","webpack:///D:/My-Document/projects/WanBig/pages/auditor/auditor.vue?2481","webpack:///D:/My-Document/projects/WanBig/pages/auditor/auditor.vue?e081","webpack:///D:/My-Document/projects/WanBig/pages/auditor/auditor.vue?0a29","webpack:///D:/My-Document/projects/WanBig/pages/auditor/auditor.vue?f47e","uni-app:///pages/auditor/auditor.vue","webpack:///D:/My-Document/projects/WanBig/pages/auditor/auditor.vue?9ab0"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","renderjs","component","options","__file","components","uniSection","uniLoadMore","uniPopup","uniPopupDialog","uniIcons","e","message","indexOf","console","error","render","_vm","this","_h","$createElement","l0","_self","_c","__map","goodsInfo","item","index","$orig","__get_orig","g0","checkedArr","includes","String","m0","g1","$mp","data","Object","assign","$root","recyclableRender","staticRenderFns","_withStripped","util","isAuditorRadio","isChecked","allChecked","status","isEnd","page","reason","contentText","contentdown","contentrefresh","contentnomore","onLoad","methods","inputDialogToggle","currentItem","dialogInputConfirm","AuditedNoPass","uni","title","mask","pass","note","arr","clickLoadMore","changeCheckbox","allChoose","getNoAudited","db","audited","list","initList","batchOperation","icon","indexs","selectedGoods","unselectedGoods","recodeFails","i","itemRes","updateAudite","res","collection","doc","update","sendAuditResultNotice","riseTime","auditTime","callFunction","name","openid","goodId","goodName","auditResults","then","catch"],"mappings":"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","file":"pages/auditor/auditor.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/auditor/auditor.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./auditor.vue?vue&type=template&id=244e8704&scoped=true&\"\nvar renderjs\nimport script from \"./auditor.vue?vue&type=script&lang=js&\"\nexport * from \"./auditor.vue?vue&type=script&lang=js&\"\nimport style0 from \"./auditor.vue?vue&type=style&index=0&id=244e8704&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../uni-app开发工具/HBuilderX.3.3.13.20220314/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"244e8704\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/auditor/auditor.vue\"\nexport default component.exports","export * from \"-!../../../../../uni-app开发工具/HBuilderX.3.3.13.20220314/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../uni-app开发工具/HBuilderX.3.3.13.20220314/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../uni-app开发工具/HBuilderX.3.3.13.20220314/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../uni-app开发工具/HBuilderX.3.3.13.20220314/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../uni-app开发工具/HBuilderX.3.3.13.20220314/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../uni-app开发工具/HBuilderX.3.3.13.20220314/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./auditor.vue?vue&type=template&id=244e8704&scoped=true&\"","var components\ntry {\n  components = {\n    uniSection: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-section/components/uni-section/uni-section\" */ \"@/uni_modules/uni-section/components/uni-section/uni-section.vue\"\n      )\n    },\n    uniLoadMore: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-load-more/components/uni-load-more/uni-load-more\" */ \"@/uni_modules/uni-load-more/components/uni-load-more/uni-load-more.vue\"\n      )\n    },\n    uniPopup: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-popup/components/uni-popup/uni-popup\" */ \"@/uni_modules/uni-popup/components/uni-popup/uni-popup.vue\"\n      )\n    },\n    uniPopupDialog: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-popup/components/uni-popup-dialog/uni-popup-dialog\" */ \"@/uni_modules/uni-popup/components/uni-popup-dialog/uni-popup-dialog.vue\"\n      )\n    },\n    uniIcons: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-icons/components/uni-icons/uni-icons\" */ \"@/uni_modules/uni-icons/components/uni-icons/uni-icons.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var l0 = _vm.__map(_vm.goodsInfo, function (item, index) {\n    var $orig = _vm.__get_orig(item)\n    var g0 = _vm.checkedArr.includes(String(index))\n    var m0 = String(index)\n    var g1 = _vm.checkedArr.includes(String(index))\n    return {\n      $orig: $orig,\n      g0: g0,\n      m0: m0,\n      g1: g1,\n    }\n  })\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        l0: l0,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../uni-app开发工具/HBuilderX.3.3.13.20220314/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../uni-app开发工具/HBuilderX.3.3.13.20220314/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../uni-app开发工具/HBuilderX.3.3.13.20220314/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../uni-app开发工具/HBuilderX.3.3.13.20220314/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../uni-app开发工具/HBuilderX.3.3.13.20220314/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./auditor.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../uni-app开发工具/HBuilderX.3.3.13.20220314/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../uni-app开发工具/HBuilderX.3.3.13.20220314/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../uni-app开发工具/HBuilderX.3.3.13.20220314/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../uni-app开发工具/HBuilderX.3.3.13.20220314/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../uni-app开发工具/HBuilderX.3.3.13.20220314/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./auditor.vue?vue&type=script&lang=js&\"","<template>\n  <div>\n    <!-- 待审核section -->\n    <view class=\"section\">\n      <uni-section\n        class=\"mb-10\"\n        title=\"待审核列表\"\n        type=\"line\" />\n    </view>\n    <view class=\"xxxbox\"></view>\n\n    <!-- 主体区域 -->\n    <scroll-view scroll-y>\n      <view>\n        <checkbox-group\n          class=\"block\"\n          @change=\"changeCheckbox\">\n          <view\n            v-for=\"(item, index) in goodsInfo\"\n            :key=\"index\"\n            class=\"auditor-card\">\n            <div class=\"wrap\">\n              <div class=\"left\">\n                <checkbox\n                  :value=\"String(index)\"\n                  :checked=\"checkedArr.includes(String(index))\"\n                  :class=\"{ checked: checkedArr.includes(String(index)) }\"\n                  style=\"transform: scale(0.7)\"></checkbox>\n                <image\n                  class=\"img-good\"\n                  :src=\"item.pics[0].url\"\n                  mode=\"aspectFill\" />\n              </div>\n              <div class=\"center\">\n                <div class=\"top\">\n                  <div class=\"desc\">\n                    {{ item.title }}\n                  </div>\n                  <div class=\"price\">{{ item.price }}</div>\n                </div>\n                <div class=\"bottom\">\n                  <div class=\"label\">\n                    <div class=\"transport\">\n                      <image\n                        class=\"icon-transport\"\n                        src=\"../../static/label/transport.svg\"\n                        mode=\"\" />\n                      <span class=\"text-transport\">{{ item.delivery }}</span>\n                    </div>\n                    <div\n                      class=\"address\"\n                      v-if=\"item.delivery === '自提'\">\n                      <image\n                        class=\"icon-address\"\n                        src=\"../../static/label/address.svg\"\n                        mode=\"\" />\n                      <span class=\"text-address\">{{ item.place }}</span>\n                    </div>\n                    <div class=\"quality\">\n                      <image\n                        class=\"icon-quality\"\n                        src=\"../../static/label/quality.svg\"\n                        mode=\"\" />\n                      <span class=\"text-quality\">{{ item.condition }}</span>\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div class=\"right\">\n                <van-icon\n                  name=\"delete-o\"\n                  @click=\"inputDialogToggle(item)\"\n                  size=\"20px\"\n                  color=\"red\" />\n              </div>\n            </div>\n          </view>\n        </checkbox-group>\n      </view>\n      <uni-load-more\n        color=\"#007AFF\"\n        :status=\"status\"\n        @clickLoadMore=\"clickLoadMore\"\n        :contentText=\"contentText\" />\n    </scroll-view>\n\n    <!-- 审核不通过原因-输入框 -->\n    <uni-popup\n      ref=\"inputDialog\"\n      type=\"dialog\">\n      <uni-popup-dialog\n        ref=\"inputClose\"\n        mode=\"input\"\n        title=\"请输入不通过的原因\"\n        value=\"\"\n        placeholder=\"确认后将立即执行操作\"\n        @confirm=\"dialogInputConfirm\"></uni-popup-dialog>\n    </uni-popup>\n\n    <!-- 全选+批量 操作栏 -->\n    <div class=\"select-all\">\n      <div class=\"left\">\n        <checkbox-group @change=\"allChoose\">\n          <label>\n            <checkbox\n              value=\"all\"\n              :class=\"{ checked: allChecked }\"\n              :checked=\"allChecked ? true : false\"\n              style=\"transform: scale(0.7)\"></checkbox>\n            全选\n          </label>\n        </checkbox-group>\n      </div>\n      <div class=\"right\">\n        <button\n          size=\"mini\"\n          type=\"primary\"\n          hover-class=\"button-hover\"\n          @click=\"batchOperation(true)\">\n          <uni-icons\n            type=\"checkmarkempty\"\n            color=\"#fff\"\n            size=\"24\" />通过\n        </button>\n        <button\n          size=\"mini\"\n          type=\"warn\"\n          hover-class=\"button-hover\"\n          @click=\"batchOperation(false)\">\n          <uni-icons\n            type=\"closeempty\"\n            color=\"#fff\"\n            size=\"24\" />不通过\n        </button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nconst db = wx.cloud.database();\nvar util = require(\"../utils/formatTimeToChinese.js\");\nimport truncatedString from \"../utils/truncatedString.js\";\nconst _ = db.command;\nlet isAll = false;\nlet currentItem = null;\nexport default {\n  data() {\n    return {\n      goodsInfo: [],\n      isAuditorRadio: false,\n      isChecked: false,\n      checkedArr: [], //复选框选中的值\n      allChecked: false, //是否全选，\n      status: \"loading\",\n      isEnd: false,\n      page: 0,\n      reason: \"\",\n      contentText: {\n        contentdown: \"点击获取更多\",\n        contentrefresh: \"正在加载\",\n        contentnomore: \"没有更多数据了\",\n      },\n    };\n  },\n  async onLoad() {\n    await this.initList();\n  },\n  methods: {\n    // 打开输入对话框\n    inputDialogToggle(item) {\n      this.$refs.inputDialog.open();\n      currentItem = item;\n    },\n    // 确然输入内容触发的函数\n    dialogInputConfirm(val, item) {\n      this.reason = val;\n      this.$refs.inputDialog.close();\n      this.AuditedNoPass(currentItem, val);\n    },\n    // 单个不过审操作\n    async AuditedNoPass(item, reason = \"\") {\n      uni.showLoading({\n        title: \"正在操作\",\n        mask: true,\n      });\n      console.log(\"item :>> \", item);\n      console.log(\"reason :>> \", reason);\n      await this.updateAudite(item, false, reason);\n\n      // 发送通知用户该审核不通过\n      let pass = \"不通过\";\n      let note = `${reason}，请整改后重新发布`;\n      await this.sendAuditResultNotice(item, pass, note, false); //单项操作，不是批量操作\n\n      // 在当前数组中删除该项\n      this.goodsInfo.forEach((element, index, arr) => {\n        if (element._id === item._id) {\n          console.log(\"删除当前项\", element._id);\n          arr.splice(index, 1);\n        }\n      });\n\n      console.log(this.goodsInfo);\n      uni.hideLoading();\n    },\n    // 加载更多\n    clickLoadMore(e) {\n      console.log(\"加载更多 :>> \", e);\n      if (isAll) {\n        return;\n      }\n      this.getNoAudited();\n    },\n    // 多选复选框改变事件\n    changeCheckbox(e) {\n      console.log(\"change   :>> \", e);\n      this.checkedArr = e.detail.value;\n      // 如果选择的数组中有值，并且长度等于列表的长度，就是全选\n      if (this.checkedArr.length > 0 && this.checkedArr.length == this.goodsInfo.length) {\n        this.allChecked = true;\n      } else {\n        this.allChecked = false;\n      }\n    },\n    // 全选事件\n    allChoose(e) {\n      console.log(\"全选 :>> \", e);\n      let chooseItem = e.detail.value;\n      // 全选\n      if (chooseItem[0] == \"all\") {\n        this.allChecked = true;\n\n        for (let i = 0; i < this.goodsInfo.length; i++) {\n          let itemVal = String(i);\n          if (!this.checkedArr.includes(itemVal)) {\n            this.checkedArr.push(itemVal);\n          }\n        }\n      } else {\n        // 取消全选\n        this.allChecked = false;\n        this.checkedArr = [];\n      }\n    },\n    // 获取未审核商品数据\n    async getNoAudited() {\n      try {\n        const { data } = await db.collection(\"goods\").where({ audited: false }).skip(this.page).limit(2).get();\n        let list = this.goodsInfo;\n        list = list.concat(data);\n        this.page += data.length;\n        this.setData({\n          goodsInfo: list,\n          status: data.length < 2 ? \"noMore\" : \"more\",\n        });\n      } catch (err) {\n        console.error(\"Error fetching data:\", err);\n      }\n    },\n    // 初始化获取未审核商品数据\n    async initList() {\n      try {\n        const { data } = await db.collection(\"goods\").where({ audited: false }).limit(2).get();\n        console.log(\"data.length, :>> \", data.length);\n        this.goodsInfo = data;\n        this.status = data.length >= 2 ? \"more\" : \"noMore\";\n        this.page += data.length;\n      } catch (err) {\n        console.error(\"Error fetching data:\", err);\n      }\n    },\n    // 批量操作\n    async batchOperation(type) {\n      // 判空\n      if (this.checkedArr.length === 0) {\n        uni.showToast({\n          title: \"请勾选一项\",\n          icon: \"error\",\n          mask: true,\n        });\n        return;\n      }\n      uni.showLoading({\n        title: \"正在处理\",\n        mask: true,\n      });\n      // 选择的索引\n      const indexs = this.checkedArr.map((item) => parseInt(item, 10));\n      // 选择的商品\n      const selectedGoods = indexs.map((index) => this.goodsInfo[index]);\n      // 未选择的商品\n      const unselectedGoods = this.goodsInfo.filter((item, index) => {\n        if (!indexs.includes(index)) {\n          return item;\n        }\n      });\n\n      console.log(indexs);\n      console.log(\"选择的good\", selectedGoods);\n      console.log(\"未选择的good\", unselectedGoods);\n\n      // 批量审核\n      let pass = type ? \"通过\" : \"不通过\";\n      let note = type ? \"快叫上小伙伴来一起发布闲置品吧\" : \"内容违规，请整改后重新发布\";\n      let recodeFails = [];\n\n      for (let i = 0; i < selectedGoods.length; i++) {\n        const item = selectedGoods[i];\n        // 更新每一项的审核值\n        let itemRes = this.updateAudite(item, type ? true : false);\n        if (itemRes) {\n          // 发送通知用户该审核通过\n          await this.sendAuditResultNotice(item, pass, note, true); // 批量操作\n        } else {\n          recodeFails.push(item);\n          continue;\n        }\n      }\n\n      // 清空勾选的索引数组和取消全选\n      this.checkedArr = [];\n      this.allChecked = false;\n      // 显示剩余的数据和失败的数据\n      this.goodsInfo = [...unselectedGoods, ...recodeFails];\n      this.page = this.goodsInfo.length;\n\n      uni.hideLoading();\n      // 操作反馈\n      uni.showToast({\n        title: `成功${selectedGoods.length - recodeFails.length},失败${recodeFails.length}`,\n        mask: true,\n      });\n    },\n    // 更新审核状态\n    async updateAudite(item, pass, reason = \"\") {\n      let res = null;\n      try {\n        // 更新audited属性为true，pass属性为false：表示已经审核，但是审核不通过\n        res = await db\n          .collection(\"goods\")\n          .doc(item._id)\n          .update({\n            data: {\n              audited: true, // 已经审核\n              pass: pass, // 审核状态\n              reason: reason, // 不通过原因\n              status: pass ? 0 : -1, // 可售状态\n            },\n          });\n\n        if (res.stats.updated > 0) {\n          console.log(\"更新审核状态成功\", res);\n          return true;\n        } else {\n          console.log(\"更新审核状态失败\", res);\n          return false;\n        }\n      } catch (error) {\n        console.log(\"更新审核状态出错 :>> \", error);\n        // 处理错误情况，例如数据库更新失败\n        // throw error; // 抛出错误以供调用者处理\n      }\n    },\n    // 发送审核通知\n    async sendAuditResultNotice(item, pass, note, batch) {\n      // 处理时间格式\n      let riseTime = util.formatTimeToChinese(item.creat);\n      let auditTime = util.formatTimeToChinese(new Date());\n      console.log(riseTime);\n      console.log(auditTime);\n\n      await wx.cloud\n        .callFunction({\n          name: \"sendAuditedRes\",\n          data: {\n            openid: item._openid, // 字符串\n            goodId: item._id, // 字符串\n            goodName: truncatedString(item.title, 20), // 字符串 使用截断\n            riseTime: riseTime, // 发起时间    // TODO\n            auditTime: auditTime, // 审核时间\n            auditResults: pass, // 字符串\n            note: note, // 字符串\n          },\n        })\n        .then((res) => {\n          console.log(\"first response: \", res);\n          if (res.result.errCode === 43101) {\n            console.log(\"用户拒绝接收，允许接收次数已使用完\", res);\n            if (!batch) {\n              // 单个操作显示，批量则不显示\n              uni.showToast({\n                title: \"用户拒绝接收\",\n                icon: \"error\",\n                mask: true,\n              });\n            }\n          }\n        })\n        .catch((err) => {\n          console.log(\"错误！！！\", err);\n          console.log(\"错误！！！\", err.errCode);\n          if (err.errCode === -1 && !batch) {\n            uni.showToast({\n              title: \"发送通知成功\",\n              icon: \"success\",\n              mask: true,\n            });\n          }\n        });\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.section {\n  position: fixed;\n  top: 0;\n  z-index: 2;\n  width: 100%;\n}\n\n.xxxbox {\n  width: 100%;\n  height: 90rpx;\n}\n\nscroll-view {\n  height: calc(100vh - 130rpx - 90rpx);\n}\n\n.select-all {\n  position: fixed;\n  bottom: 0rpx;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  width: 100%;\n  height: 130rpx;\n  font-size: 30rpx;\n  background-color: #ffc300;\n  border-radius: 20rpx;\n\n  .left {\n    padding-left: 5px;\n    font-size: 30rpx;\n    font-weight: bold;\n  }\n\n  .right {\n    display: flex;\n\n    button {\n      width: auto;\n      font-size: 30rpx;\n      line-height: 70rpx;\n      border-radius: 50rpx;\n\n      uni-icons {\n        position: relative;\n        right: 5rpx;\n        bottom: -5rpx;\n      }\n    }\n  }\n}\n\n.wrap {\n  display: flex;\n  height: 100px;\n  margin: 0 5px 10px;\n  background-color: #fff;\n  box-shadow: 1px 1.5px 5px 1px rgb(180, 179, 179);\n  border-radius: 10px;\n\n  .left {\n    display: flex;\n    align-items: center;\n    padding: 10px;\n\n    .img-good {\n      width: 80px;\n      height: 80px;\n      border-radius: 5px;\n    }\n  }\n\n  .center {\n    flex: 1;\n\n    .top {\n      margin-top: 10px;\n\n      .desc {\n        display: -webkit-box;\n        overflow: hidden;\n        min-height: 33px;\n        font-size: 13px;\n        font-weight: 500;\n        text-overflow: ellipsis;\n\n        -webkit-box-orient: vertical;\n        -webkit-line-clamp: 2;\n      }\n\n      .price {\n        padding: 5px 0 0;\n        color: #d43f3f;\n        font-weight: bold;\n      }\n    }\n\n    .bottom {\n      display: flex;\n      justify-content: space-between;\n\n      .label {\n        position: relative;\n        display: flex;\n        align-items: center;\n        height: 40rpx;\n        font-size: 16.02rpx;\n        font-weight: bolder;\n\n        .transport {\n          display: flex;\n          justify-content: center;\n          align-items: center;\n          height: 30rpx;\n          margin-top: 4rpx;\n          margin-right: 15rpx;\n          background-color: #4da4e2;\n          border-radius: 5rpx;\n\n          .text-transport {\n            margin: 10rpx;\n          }\n\n          .icon-transport {\n            width: 19.28rpx;\n            height: 19.28rpx;\n            margin-left: 10rpx;\n          }\n        }\n\n        .address {\n          display: flex;\n          justify-content: center;\n          align-items: center;\n          height: 30rpx;\n          margin-top: 4rpx;\n          margin-right: 15rpx;\n          background-color: #ffc300;\n          border-radius: 5rpx;\n\n          .text-address {\n            margin: 10rpx;\n          }\n\n          .icon-address {\n            width: 19.28rpx;\n            height: 19.28rpx;\n            margin-left: 10rpx;\n          }\n        }\n\n        .quality {\n          display: flex;\n          justify-content: center;\n          align-items: center;\n          height: 30rpx;\n          margin-top: 4rpx;\n          margin-right: 15rpx;\n          background-color: #ffc300;\n          border-radius: 5rpx;\n\n          .text-quality {\n            margin: 10rpx;\n          }\n\n          .icon-quality {\n            width: 17.52rpx;\n            height: 17.52rpx;\n            margin-left: 10rpx;\n          }\n        }\n      }\n\n      .browse {\n        display: flex;\n        align-items: center;\n        padding-right: 20px;\n\n        .icon-eye {\n          padding-right: 5px;\n        }\n\n        .num {\n          font-size: 10px;\n          text-align: center;\n        }\n      }\n    }\n  }\n\n  .right {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    width: 40px;\n    background-color: #eee;\n    border-radius: 0 10px 10px 0;\n  }\n}\n</style>\n","import mod from \"-!../../../../../uni-app开发工具/HBuilderX.3.3.13.20220314/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../uni-app开发工具/HBuilderX.3.3.13.20220314/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../uni-app开发工具/HBuilderX.3.3.13.20220314/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../uni-app开发工具/HBuilderX.3.3.13.20220314/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../uni-app开发工具/HBuilderX.3.3.13.20220314/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../uni-app开发工具/HBuilderX.3.3.13.20220314/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../uni-app开发工具/HBuilderX.3.3.13.20220314/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../uni-app开发工具/HBuilderX.3.3.13.20220314/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../uni-app开发工具/HBuilderX.3.3.13.20220314/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./auditor.vue?vue&type=style&index=0&id=244e8704&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../uni-app开发工具/HBuilderX.3.3.13.20220314/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../uni-app开发工具/HBuilderX.3.3.13.20220314/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../uni-app开发工具/HBuilderX.3.3.13.20220314/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../uni-app开发工具/HBuilderX.3.3.13.20220314/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../uni-app开发工具/HBuilderX.3.3.13.20220314/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../uni-app开发工具/HBuilderX.3.3.13.20220314/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../uni-app开发工具/HBuilderX.3.3.13.20220314/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../uni-app开发工具/HBuilderX.3.3.13.20220314/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../uni-app开发工具/HBuilderX.3.3.13.20220314/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./auditor.vue?vue&type=style&index=0&id=244e8704&lang=scss&scoped=true&\""],"sourceRoot":""}